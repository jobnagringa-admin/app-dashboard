---
/**
 * Select Component - Dropdown select field
 *
 * @prop {string} name - Select name attribute
 * @prop {string} id - Select id attribute (defaults to name)
 * @prop {Array<{value: string, label: string}>} options - Select options
 * @prop {string} placeholder - Placeholder option text
 * @prop {string} value - Selected value
 * @prop {string} class - Additional CSS classes
 * @prop {boolean} isJobSearch - Use job search styling
 * @prop {string} filterField - Finsweet CMS filter field attribute
 * @prop {string} label - Accessible label for the select (required for a11y)
 * @prop {string} ariaLabel - ARIA label as alternative to visible label
 * @prop {boolean} required - Whether the field is required
 */

interface SelectOption {
  value: string;
  label: string;
}

interface Props {
  name: string;
  id?: string;
  options: SelectOption[];
  placeholder?: string;
  value?: string;
  class?: string;
  isJobSearch?: boolean;
  filterField?: string;
  label?: string;
  ariaLabel?: string;
  required?: boolean;
}

const {
  name,
  id,
  options,
  placeholder = '',
  value = '',
  class: className = '',
  isJobSearch = false,
  filterField,
  label,
  ariaLabel,
  required = false,
} = Astro.props;

const selectId = id || name;
const baseClass = isJobSearch ? 'job-search_select input_select' : 'input_field is-select';
const finalClass = `${baseClass} ${className} w-select`.trim();

const filterAttr = filterField ? { 'fs-cmsfilter-field': filterField } : {};
---

{label ? (
  <div class="select-wrapper">
    <label for={selectId} class="select-label">{label}{required && <span class="required-indicator" aria-hidden="true">*</span>}</label>
    <select
      id={selectId}
      name={name}
      data-name={name}
      class={finalClass}
      aria-required={required ? 'true' : undefined}
      {...filterAttr}
    >
      {placeholder && <option value="">{placeholder}</option>}
      {
        options.map((option) => (
          <option value={option.value} selected={option.value === value}>
            {option.label}
          </option>
        ))
      }
    </select>
  </div>
) : (
  <select
    id={selectId}
    name={name}
    data-name={name}
    class={finalClass}
    aria-label={ariaLabel || placeholder || name}
    aria-required={required ? 'true' : undefined}
    {...filterAttr}
  >
    {placeholder && <option value="">{placeholder}</option>}
    {
      options.map((option) => (
        <option value={option.value} selected={option.value === value}>
          {option.label}
        </option>
      ))
    }
  </select>
)}
