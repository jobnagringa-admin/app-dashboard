---
/**
 * WebflowScripts.astro
 *
 * Webflow Runtime and Dependencies
 *
 * Purpose:
 * - Load jQuery (required by Webflow)
 * - Load Webflow runtime JS for interactions and commerce
 * - Load Google Web Fonts loader
 *
 * CDN Resources Used:
 * - jQuery 3.5.1 from Cloudflare CDN (d3e54v103j8qbb.cloudfront.net)
 * - Google Web Font Loader from Google APIs
 * - Local webflow.js for interactions
 *
 * Environment Variables Required:
 * - None (uses static CDN URLs)
 *
 * Migration Notes:
 * - Original jQuery loaded from Cloudflare CDN with SRI hash
 * - Webflow JS is large (~1.8MB) and handles interactions
 * - Consider lazy loading or code splitting for webflow.js
 * - Google Fonts: Inter (all weights)
 *
 * SSR Considerations:
 * - All scripts are client-side only
 * - jQuery is required for Webflow interactions to work
 * - webflow.js initializes automatically on DOM ready
 */

interface Props {
  /**
   * Load jQuery from CDN
   * @default true
   */
  includeJquery?: boolean;

  /**
   * Load Google Web Fonts
   * @default true
   */
  includeWebFonts?: boolean;

  /**
   * Font families to load
   * @default ['Inter']
   */
  fontFamilies?: string[];

  /**
   * Webflow site ID for asset loading
   */
  siteId?: string;
}

const {
  includeJquery = true,
  includeWebFonts = true,
  fontFamilies = ['Inter:100,200,300,regular,500,600,700,800,900,100italic,200italic,300italic,italic,500italic,600italic,700italic,800italic,900italic'],
  siteId = '642953c962519376c853ab81'
} = Astro.props;

// CDN URLs
const jqueryUrl = `https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=${siteId}`;
const jquerySri = 'sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=';
const webfontUrl = 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js';
---

{/* Google Fonts Preconnect */}
{includeWebFonts && (
  <>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous" />
  </>
)}

{/* Google Web Font Loader */}
{includeWebFonts && (
  <>
    <script src={webfontUrl}></script>
    <script is:inline define:vars={{ fontFamilies }}>
      WebFont.load({
        google: {
          families: fontFamilies
        }
      });
    </script>
  </>
)}

{/* Webflow Touch Detection */}
<script is:inline>
  !function(o, c) {
    var n = c.documentElement,
      t = " w-mod-";
    n.className += t + "js";
    ("ontouchstart" in o || (o.DocumentTouch && c instanceof DocumentTouch)) &&
      (n.className += t + "touch");
  }(window, document);
</script>
